#include "bitboard.hpp"
#include "third_party/doctest.h"
#include "types.hpp"

TEST_CASE("BITBOARD::RING") {
    CHECK_EQ(RINGS[A1][7], 0xff80808080808080);
    CHECK_EQ(RINGS[A8][7], 0x80808080808080ff);
    CHECK_EQ(RINGS[H1][7], 0xff01010101010101);
    CHECK_EQ(RINGS[H8][7], 0x1010101010101ff);
}

TEST_CASE("BITBOARD::SQ_RAY") {
    CHECK_EQ(SQRAYS[A1][A2], 0x101010101010100);
    CHECK_EQ(SQRAYS[A1][B1], 0xfelu);
    CHECK_EQ(SQRAYS[A1][B2], 0x8040201008040200);

    CHECK_EQ(SQRAYS[A8][A7], 0x1010101010101);
    CHECK_EQ(SQRAYS[A8][B8], 0xfe00000000000000);
    CHECK_EQ(SQRAYS[A8][B7], 0x2040810204080);

    CHECK_EQ(SQRAYS[H1][H2], 0x8080808080808000);
    CHECK_EQ(SQRAYS[H1][G1], 0x7flu);
    CHECK_EQ(SQRAYS[H1][G2], 0x102040810204000);

    CHECK_EQ(SQRAYS[H8][H7], 0x80808080808080);
    CHECK_EQ(SQRAYS[H8][G8], 0x7f00000000000000);
    CHECK_EQ(SQRAYS[H8][G7], 0x40201008040201);
}

TEST_CASE("BITBOARD::DIR_RAY") {
    CHECK_EQ(RAYS[A1][NORTH], 0x101010101010100);
    CHECK_EQ(RAYS[A1][EAST], 0xfelu);
    CHECK_EQ(RAYS[A1][NORTH_EAST], 0x8040201008040200);

    CHECK_EQ(RAYS[A8][SOUTH], 0x1010101010101);
    CHECK_EQ(RAYS[A8][EAST], 0xfe00000000000000);
    CHECK_EQ(RAYS[A8][SOUTH_EAST], 0x2040810204080);

    CHECK_EQ(RAYS[H1][NORTH], 0x8080808080808000);
    CHECK_EQ(RAYS[H1][WEST], 0x7flu);
    CHECK_EQ(RAYS[H1][NORTH_WEST], 0x102040810204000);

    CHECK_EQ(RAYS[H8][SOUTH], 0x80808080808080);
    CHECK_EQ(RAYS[H8][WEST], 0x7f00000000000000);
    CHECK_EQ(RAYS[H8][SOUTH_WEST], 0x40201008040201);
}

TEST_CASE("BITBOARD::XRay") {
    CHECK_EQ(XRAYS[A1][A2], 0x101010101010000);
    CHECK_EQ(XRAYS[A1][B1], 0xfclu);
    CHECK_EQ(XRAYS[A1][B2], 0x8040201008040000);

    CHECK_EQ(XRAYS[A8][A7], 0x10101010101);
    CHECK_EQ(XRAYS[A8][B8], 0xfc00000000000000);
    CHECK_EQ(XRAYS[A8][B7], 0x40810204080);

    CHECK_EQ(XRAYS[H1][H2], 0x8080808080800000);
    CHECK_EQ(XRAYS[H1][G1], 0x3flu);
    CHECK_EQ(XRAYS[H1][G2], 0x102040810200000);

    CHECK_EQ(XRAYS[H8][H7], 0x808080808080);
    CHECK_EQ(XRAYS[H8][G8], 0x3f00000000000000);
    CHECK_EQ(XRAYS[H8][G7], 0x201008040201);
}

TEST_CASE("BITBOARD::PawnAttacks") {
    CHECK_EQ(PAWN_ATTACKS[WHITE][A2], 0x20000);
    CHECK_EQ(PAWN_ATTACKS[WHITE][H2], 0x400000);
    CHECK_EQ(PAWN_ATTACKS[BLACK][A7], 0x20000000000);
    CHECK_EQ(PAWN_ATTACKS[BLACK][H7], 0x400000000000);

    CHECK_EQ(PAWN_ATTACKS[WHITE][D2], 0x140000);
    CHECK_EQ(PAWN_ATTACKS[WHITE][E2], 0x280000);
    CHECK_EQ(PAWN_ATTACKS[BLACK][D7], 0x140000000000);
    CHECK_EQ(PAWN_ATTACKS[BLACK][E7], 0x280000000000);
}

TEST_CASE("BITBOARD::KnightAttacks") {
    CHECK_EQ(ATTACKS[KNIGHT][A1], 0x20400);
    CHECK_EQ(ATTACKS[KNIGHT][H1], 0x402000);
    CHECK_EQ(ATTACKS[KNIGHT][A8], 0x4020000000000);
    CHECK_EQ(ATTACKS[KNIGHT][H8], 0x20400000000000);

    CHECK_EQ(ATTACKS[KNIGHT][D4], 0x142200221400);
    CHECK_EQ(ATTACKS[KNIGHT][D5], 0x14220022140000);
    CHECK_EQ(ATTACKS[KNIGHT][E4], 0x284400442800);
    CHECK_EQ(ATTACKS[KNIGHT][E5], 0x28440044280000);
}

TEST_CASE("BITBOARD::BishopAttacks") {
    CHECK_EQ(ATTACKS[BISHOP][A1], 0x8040201008040200);
    CHECK_EQ(ATTACKS[BISHOP][H1], 0x102040810204000);
    CHECK_EQ(ATTACKS[BISHOP][A8], 0x2040810204080);
    CHECK_EQ(ATTACKS[BISHOP][H8], 0x40201008040201);

    CHECK_EQ(ATTACKS[BISHOP][D4], 0x8041221400142241);
    CHECK_EQ(ATTACKS[BISHOP][D5], 0x4122140014224180);
    CHECK_EQ(ATTACKS[BISHOP][E4], 0x182442800284482);
    CHECK_EQ(ATTACKS[BISHOP][E5], 0x8244280028448201);
}

TEST_CASE("BITBOARD::RookAttacks") {
    CHECK_EQ(ATTACKS[ROOK][A1], 0x1010101010101fe);
    CHECK_EQ(ATTACKS[ROOK][H1], 0x808080808080807f);
    CHECK_EQ(ATTACKS[ROOK][A8], 0xfe01010101010101);
    CHECK_EQ(ATTACKS[ROOK][H8], 0x7f80808080808080);

    CHECK_EQ(ATTACKS[ROOK][D4], 0x8080808f7080808);
    CHECK_EQ(ATTACKS[ROOK][D5], 0x80808f708080808);
    CHECK_EQ(ATTACKS[ROOK][E4], 0x10101010ef101010);
    CHECK_EQ(ATTACKS[ROOK][E5], 0x101010ef10101010);
}

TEST_CASE("BITBOARD::QueenAttacks") {
    CHECK_EQ(ATTACKS[QUEEN][A1], 0x81412111090503fe);
    CHECK_EQ(ATTACKS[QUEEN][H1], 0x8182848890a0c07f);
    CHECK_EQ(ATTACKS[QUEEN][A8], 0xfe03050911214181);
    CHECK_EQ(ATTACKS[QUEEN][H8], 0x7fc0a09088848281);
}
